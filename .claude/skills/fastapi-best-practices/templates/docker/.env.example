# ========================================
# FastAPI 环境变量配置示例
# ========================================
#
# 使用说明：
# 1. 复制此文件：cp .env.example .env.dev（开发环境）
# 2. 复制此文件：cp .env.example .env.test（测试环境）
# 3. 复制此文件：cp .env.example .env.prod（生产环境）
# 4. 根据环境修改相应的配置
# 5. 启动：docker-compose --env-file .env.dev up -d

# ========================================
# 应用配置
# ========================================

# 运行环境：development/testing/production
ENV=development

# 镜像名称和标签
IMAGE_NAME=myapp
IMAGE_TAG=latest

# 容器名称
CONTAINER_NAME=myapp-dev

# ========================================
# 端口配置（重要！）
# ========================================

# 应用端口（容器内部端口，通常不需要修改）
APP_PORT=8000

# 宿主机端口（映射到外部的端口）
# 开发环境示例：8000
# 测试环境示例：8001 或 8080
# 生产环境示例：80 或 443
HOST_PORT=8000

# ========================================
# 性能配置
# ========================================

# Uvicorn Workers 数量
# 开发环境：1
# 测试环境：2
# 生产环境：建议 (CPU 核心数 * 2 + 1)
WORKERS=1

# ========================================
# 数据库配置
# ========================================

# 数据库容器名称
DB_CONTAINER_NAME=myapp-db-dev

# 数据库端口（映射到外部的端口，避免与本地 PostgreSQL 冲突）
# 开发环境：5432
# 测试环境：5433
# 生产环境：5432（通常不对外暴露）
DB_PORT=5432

# 数据库连接信息
DB_USER=myapp
DB_PASSWORD=myapp_password_change_in_production
DB_NAME=myapp
DB_HOST=db

# 数据库连接 URL
DATABASE_URL=postgresql://${DB_USER}:${DB_PASSWORD}@${DB_HOST}:5432/${DB_NAME}

# ========================================
# Redis 配置
# ========================================

# Redis 容器名称
REDIS_CONTAINER_NAME=myapp-redis-dev

# Redis 端口（映射到外部的端口）
# 开发环境：6379
# 测试环境：6380
# 生产环境：6379（通常不对外暴露）
REDIS_PORT=6379

# Redis 连接 URL
REDIS_URL=redis://redis:6379/0

# ========================================
# 安全配置
# ========================================

# JWT 密钥（生产环境必须修改！）
SECRET_KEY=your-secret-key-please-change-in-production

# JWT 过期时间（分钟）
ACCESS_TOKEN_EXPIRE_MINUTES=30

# ========================================
# CORS 配置
# ========================================

# 允许的源（多个用逗号分隔）
# 开发环境：http://localhost:3000,http://localhost:5173
# 测试环境：https://test.example.com
# 生产环境：https://example.com,https://www.example.com
CORS_ORIGINS=http://localhost:3000,http://localhost:5173

# ========================================
# 日志配置
# ========================================

# 日志级别：debug/info/warning/error
LOG_LEVEL=info

# ========================================
# 多环境配置示例
# ========================================

# --- 开发环境 (.env.dev) ---
# ENV=development
# HOST_PORT=8000
# DB_PORT=5432
# REDIS_PORT=6379
# WORKERS=1
# LOG_LEVEL=debug

# --- 测试环境 (.env.test) ---
# ENV=testing
# HOST_PORT=8001
# DB_PORT=5433
# REDIS_PORT=6380
# WORKERS=2
# LOG_LEVEL=info

# --- 生产环境 (.env.prod) ---
# ENV=production
# HOST_PORT=80
# DB_PORT=5432  # 不对外暴露
# REDIS_PORT=6379  # 不对外暴露
# WORKERS=5  # 根据服务器 CPU 核心数调整
# LOG_LEVEL=warning
# SECRET_KEY=<生成强随机密钥>
# DB_PASSWORD=<强密码>
